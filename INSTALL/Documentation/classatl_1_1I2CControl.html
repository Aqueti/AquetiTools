<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>AquetiTools: atl::I2CControl Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AquetiTools
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>atl</b></li><li class="navelem"><a class="el" href="classatl_1_1I2CControl.html">I2CControl</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classatl_1_1I2CControl-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">atl::I2CControl Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a8d915569ec010236111694d9cd7fa04c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classatl_1_1I2CControl.html#a8d915569ec010236111694d9cd7fa04c">connect</a> (std::string deviceId, std::string filename, uint16_t addr)</td></tr>
<tr class="memdesc:a8d915569ec010236111694d9cd7fa04c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#a8d915569ec010236111694d9cd7fa04c">More...</a><br /></td></tr>
<tr class="separator:a8d915569ec010236111694d9cd7fa04c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24dedc8a8e44f79aaf1c67309437f128"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classatl_1_1I2CControl.html#a24dedc8a8e44f79aaf1c67309437f128">~I2CControl</a> ()</td></tr>
<tr class="memdesc:a24dedc8a8e44f79aaf1c67309437f128"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="#a24dedc8a8e44f79aaf1c67309437f128">More...</a><br /></td></tr>
<tr class="separator:a24dedc8a8e44f79aaf1c67309437f128"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acafc5bfc23a737c6b79134d2d81e949c"><td class="memItemLeft" align="right" valign="top">std::vector&lt; uint8_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classatl_1_1I2CControl.html#acafc5bfc23a737c6b79134d2d81e949c">readData</a> (std::string deviceId, int nbytes=1)</td></tr>
<tr class="memdesc:acafc5bfc23a737c6b79134d2d81e949c"><td class="mdescLeft">&#160;</td><td class="mdescRight">reads the specified number of bytes from the bus  <a href="#acafc5bfc23a737c6b79134d2d81e949c">More...</a><br /></td></tr>
<tr class="separator:acafc5bfc23a737c6b79134d2d81e949c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a703217e7dd967a1b9c385d115262cc11"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classatl_1_1I2CControl.html#a703217e7dd967a1b9c385d115262cc11">writeData</a> (std::string deviceId, uint8_t *buffer, int nbytes)</td></tr>
<tr class="memdesc:a703217e7dd967a1b9c385d115262cc11"><td class="mdescLeft">&#160;</td><td class="mdescRight">Genrate an i2C package and send with the given data.  <a href="#a703217e7dd967a1b9c385d115262cc11">More...</a><br /></td></tr>
<tr class="separator:a703217e7dd967a1b9c385d115262cc11"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a47fe1b9d89d35a1f88be9dde655f1c2a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classatl_1_1I2CControl.html#a47fe1b9d89d35a1f88be9dde655f1c2a">setPointer</a> (int fd, uint16_t address)</td></tr>
<tr class="memdesc:a47fe1b9d89d35a1f88be9dde655f1c2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to set the file offset to the correct address.  <a href="#a47fe1b9d89d35a1f88be9dde655f1c2a">More...</a><br /></td></tr>
<tr class="separator:a47fe1b9d89d35a1f88be9dde655f1c2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a91532db855f921e32df4c171dc8540f4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a91532db855f921e32df4c171dc8540f4"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classatl_1_1I2CControl.html#a91532db855f921e32df4c171dc8540f4">m_crcCheckFlag</a> = true</td></tr>
<tr class="memdesc:a91532db855f921e32df4c171dc8540f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag to indicate we need to validate CRC. <br /></td></tr>
<tr class="separator:a91532db855f921e32df4c171dc8540f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37cee8256dd3ae5c2dc9dfbc0b4e792b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a37cee8256dd3ae5c2dc9dfbc0b4e792b"></a>
<a class="el" href="classatl_1_1CRC16.html">CRC16</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classatl_1_1I2CControl.html#a37cee8256dd3ae5c2dc9dfbc0b4e792b">m_crc</a></td></tr>
<tr class="memdesc:a37cee8256dd3ae5c2dc9dfbc0b4e792b"><td class="mdescLeft">&#160;</td><td class="mdescRight">CRC class. <br /></td></tr>
<tr class="separator:a37cee8256dd3ae5c2dc9dfbc0b4e792b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e2c767fb97332f81d7b800ffad1cb15"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8e2c767fb97332f81d7b800ffad1cb15"></a>
std::map&lt; std::string, int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classatl_1_1I2CControl.html#a8e2c767fb97332f81d7b800ffad1cb15">m_filenameToFdMap</a></td></tr>
<tr class="memdesc:a8e2c767fb97332f81d7b800ffad1cb15"><td class="mdescLeft">&#160;</td><td class="mdescRight">map of open file pointers by name <br /></td></tr>
<tr class="separator:a8e2c767fb97332f81d7b800ffad1cb15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee26fdf9209cd252229260c62f23c190"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aee26fdf9209cd252229260c62f23c190"></a>
std::map&lt; std::string, std::pair&lt; int, uint16_t &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classatl_1_1I2CControl.html#aee26fdf9209cd252229260c62f23c190">m_mCamToDeviceMap</a></td></tr>
<tr class="memdesc:aee26fdf9209cd252229260c62f23c190"><td class="mdescLeft">&#160;</td><td class="mdescRight">map of devices to file/address pairs <br /></td></tr>
<tr class="separator:aee26fdf9209cd252229260c62f23c190"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a24dedc8a8e44f79aaf1c67309437f128"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">atl::I2CControl::~I2CControl </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destructor. </p>
<p>On exit, the destructor closes all open files </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a8d915569ec010236111694d9cd7fa04c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool atl::I2CControl::connect </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>deviceId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>addr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">deviceId</td><td>unique id provided by the application </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td>i2c device file to connect to </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">addr</td><td>i2c device address to connect to </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true on success, false on failure</dd></dl>
<p>This function establishes an i2c connection for a given device. Each I2C device is acessible via a file interface. If the file specified by filename is already open, the constructor creates a mapping between the deviceId and the file/address pair. If the file is not opened, then it is opened prior to creating the mapping. All file descriptors are closed on exit. </p>

</div>
</div>
<a class="anchor" id="acafc5bfc23a737c6b79134d2d81e949c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; uint8_t &gt; atl::I2CControl::readData </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>deviceId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nbytes</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>reads the specified number of bytes from the bus </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">deviceId</td><td>application provided id for the device </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nbytes</td><td>number of bytes to read (default = 1) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>vector of received bytes. The vector will have no elements on failure</dd></dl>
<p>This function reads data from the device specified by the deviceId. This function strips the header and crc bytes from the incoming packets and returns the packet payload. </p>

</div>
</div>
<a class="anchor" id="a47fe1b9d89d35a1f88be9dde655f1c2a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool atl::I2CControl::setPointer </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>address</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to set the file offset to the correct address. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">deviceId</td><td>component unique id </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">address</td><td>16bit address to move to</td></tr>
  </table>
  </dd>
</dl>
<p>This function aligns the file pointer to the appropriate address for reading and writing. It is called prior to any reads or writes. </p>

</div>
</div>
<a class="anchor" id="a703217e7dd967a1b9c385d115262cc11"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool atl::I2CControl::writeData </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>deviceId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nbytes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Genrate an i2C package and send with the given data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">deviceId</td><td>application provided id for the device </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nbytes</td><td>number of bytes to read (default = 1)</td></tr>
  </table>
  </dd>
</dl>
<p>This function writes the payload specified data buffer to the i2c device specified by deviceId. The i2C packet including CRC calculations are handled internally and should not be included in the buffer to be sent. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>I2C/<a class="el" href="I2CControl_8hpp_source.html">I2CControl.hpp</a></li>
<li>I2C/I2CControl.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Jun 21 2017 15:09:33 for AquetiTools by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
